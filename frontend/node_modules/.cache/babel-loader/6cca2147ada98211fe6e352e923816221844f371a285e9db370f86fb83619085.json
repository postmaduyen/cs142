{"ast":null,"code":"var _jsxFileName = \"/home/quan/project6_photoSharing/frontend/src/components/UserPhotos/index.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from \"react\";\nimport { Typography, Button, TextField } from \"@mui/material\";\nimport { useParams } from \"react-router-dom\";\nimport fetchModel from \"../../lib/fetchModelData\";\nimport axios from \"axios\";\nimport \"./styles.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction UserPhotos(props) {\n  _s();\n  const user = props.user;\n  const {\n    userId\n  } = useParams();\n  const [photos, setPhotos] = useState([]);\n  const [newComment, setNewComment] = useState(\"\");\n  const [currentPhotoId, setCurrentPhotoId] = useState(null);\n  const uploadInputRef = useRef(null);\n  const fetchUserPhotos = async () => {\n    try {\n      const data = await fetchModel(`photo/${userId}`);\n      setPhotos(data);\n    } catch (error) {\n      console.error(\"Error fetching user photos:\", error);\n    }\n  };\n  const handleAddPhoto = async () => {\n    if (uploadInputRef.current && uploadInputRef.current.files.length > 0) {\n      const formData = new FormData();\n      formData.append(\"uploadedphoto\", uploadInputRef.current.files[0]);\n      try {\n        await axios.post(`http://localhost:8081/api/photo/new/${user._id}`, formData);\n        // Wait for the photo to be successfully uploaded, then fetch the user photos again.\n        fetchUserPhotos();\n      } catch (err) {\n        console.error(\"POST ERR:\", err);\n      }\n    }\n  };\n  const handleAddComment = async photoId => {\n    if (newComment.trim() !== \"\") {\n      try {\n        await axios.post(`http://localhost:8081/api/comment/${photoId}`, {\n          comment: newComment,\n          user: props.user\n        });\n        setNewComment(\"\");\n        fetchUserPhotos();\n      } catch (err) {\n        console.error(\"Error adding comment:\", err);\n      }\n    }\n  };\n  useEffect(() => {\n    fetchUserPhotos();\n  }, [userId]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"user-photos-container\",\n    children: [/*#__PURE__*/_jsxDEV(Typography, {\n      variant: \"body1\",\n      children: [\"User Photos for User ID: \", userId]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 7\n    }, this), props.user._id === userId && /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"file\",\n        accept: \"image/*\",\n        ref: uploadInputRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"contained\",\n        color: \"primary\",\n        onClick: handleAddPhoto,\n        style: {\n          marginBottom: \"20px\"\n        },\n        children: \"Add Photo\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 9\n    }, this), photos.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"No photos found for this user.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 9\n    }, this) : photos.map(photo => /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"photo-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"img\", {\n        src: `http://localhost:8081/api/photo/images/${photo.file_name}`,\n        alt: `Photo by user ${userId}`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"photo-details\",\n        children: [/*#__PURE__*/_jsxDEV(Typography, {\n          variant: \"body2\",\n          children: [\"Time: \", photo.date_time]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(Typography, {\n          variant: \"h6\",\n          children: \"Comments\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"comments-section\",\n          children: photo.comments.map(comment => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"comment-item\",\n            children: [/*#__PURE__*/_jsxDEV(Typography, {\n              variant: \"body2\",\n              children: [\"src\", `http://localhost:8081/api/photo/images/${comment.user_id}`, \": \", comment.comment]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 92,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(Typography, {\n              variant: \"body2\",\n              children: [\"Time: \", comment.date_time]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 97,\n              columnNumber: 21\n            }, this)]\n          }, comment._id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 91,\n            columnNumber: 19\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(TextField, {\n          label: \"Add a comment\",\n          variant: \"outlined\",\n          fullWidth: true,\n          value: newComment,\n          onChange: e => {\n            setNewComment(e.target.value);\n            setCurrentPhotoId(photo._id);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"contained\",\n          color: \"primary\",\n          onClick: () => handleAddComment(photo._id),\n          style: {\n            marginTop: \"10px\"\n          },\n          children: \"Add Comment\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 13\n      }, this)]\n    }, photo._id, true, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 11\n    }, this))]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 62,\n    columnNumber: 5\n  }, this);\n}\n_s(UserPhotos, \"OVF6pJNppVfgyJEPiNjRHjhjjzI=\", false, function () {\n  return [useParams];\n});\n_c = UserPhotos;\nexport default UserPhotos;\nvar _c;\n$RefreshReg$(_c, \"UserPhotos\");","map":{"version":3,"names":["React","useState","useEffect","useRef","Typography","Button","TextField","useParams","fetchModel","axios","jsxDEV","_jsxDEV","UserPhotos","props","_s","user","userId","photos","setPhotos","newComment","setNewComment","currentPhotoId","setCurrentPhotoId","uploadInputRef","fetchUserPhotos","data","error","console","handleAddPhoto","current","files","length","formData","FormData","append","post","_id","err","handleAddComment","photoId","trim","comment","className","children","variant","fileName","_jsxFileName","lineNumber","columnNumber","type","accept","ref","color","onClick","style","marginBottom","map","photo","src","file_name","alt","date_time","comments","user_id","label","fullWidth","value","onChange","e","target","marginTop","_c","$RefreshReg$"],"sources":["/home/quan/project6_photoSharing/frontend/src/components/UserPhotos/index.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\nimport { Typography, Button, TextField } from \"@mui/material\";\nimport { useParams } from \"react-router-dom\";\nimport fetchModel from \"../../lib/fetchModelData\";\nimport axios from \"axios\";\nimport \"./styles.css\";\n\nfunction UserPhotos(props) {\n  const user = props.user;\n  const { userId } = useParams();\n  const [photos, setPhotos] = useState([]);\n  const [newComment, setNewComment] = useState(\"\");\n  const [currentPhotoId, setCurrentPhotoId] = useState(null);\n  const uploadInputRef = useRef(null);\n\n  const fetchUserPhotos = async () => {\n    try {\n      const data = await fetchModel(`photo/${userId}`);\n      setPhotos(data);\n    } catch (error) {\n      console.error(\"Error fetching user photos:\", error);\n    }\n  };\n\n  const handleAddPhoto = async () => {\n    if (uploadInputRef.current && uploadInputRef.current.files.length > 0) {\n      const formData = new FormData();\n      formData.append(\"uploadedphoto\", uploadInputRef.current.files[0]);\n      try {\n        await axios.post(\n          `http://localhost:8081/api/photo/new/${user._id}`,\n          formData\n        );\n        // Wait for the photo to be successfully uploaded, then fetch the user photos again.\n        fetchUserPhotos();\n      } catch (err) {\n        console.error(\"POST ERR:\", err);\n      }\n    }\n  };\n\n  const handleAddComment = async (photoId) => {\n    if (newComment.trim() !== \"\") {\n      try {\n        await axios.post(`http://localhost:8081/api/comment/${photoId}`, {\n          comment: newComment,\n          user: props.user,\n        });\n        setNewComment(\"\");\n        fetchUserPhotos();\n      } catch (err) {\n        console.error(\"Error adding comment:\", err);\n      }\n    }\n  };\n\n  useEffect(() => {\n    fetchUserPhotos();\n  }, [userId]);\n\n  return (\n    <div className=\"user-photos-container\">\n      <Typography variant=\"body1\">User Photos for User ID: {userId}</Typography>\n      {props.user._id === userId && (\n        <div>\n          <input type=\"file\" accept=\"image/*\" ref={uploadInputRef} />\n          <Button\n            variant=\"contained\"\n            color=\"primary\"\n            onClick={handleAddPhoto}\n            style={{ marginBottom: \"20px\" }}\n          >\n            Add Photo\n          </Button>\n        </div>\n      )}\n      {photos.length === 0 ? (\n        <div>No photos found for this user.</div>\n      ) : (\n        photos.map((photo) => (\n          <div key={photo._id} className=\"photo-container\">\n            <img\n              src={`http://localhost:8081/api/photo/images/${photo.file_name}`}\n              alt={`Photo by user ${userId}`}\n            />\n            <div className=\"photo-details\">\n              <Typography variant=\"body2\">Time: {photo.date_time}</Typography>\n              <Typography variant=\"h6\">Comments</Typography>\n              <div className=\"comments-section\">\n                {photo.comments.map((comment) => (\n                  <div key={comment._id} className=\"comment-item\">\n                    <Typography variant=\"body2\">\n                      src\n                      {`http://localhost:8081/api/photo/images/${comment.user_id}`}\n                      : {comment.comment}\n                    </Typography>\n                    <Typography variant=\"body2\">\n                      Time: {comment.date_time}\n                    </Typography>\n                  </div>\n                ))}\n              </div>\n              <TextField\n                label=\"Add a comment\"\n                variant=\"outlined\"\n                fullWidth\n                value={newComment}\n                onChange={(e) => {\n                  setNewComment(e.target.value);\n                  setCurrentPhotoId(photo._id);\n                }}\n              />\n              <Button\n                variant=\"contained\"\n                color=\"primary\"\n                onClick={() => handleAddComment(photo._id)}\n                style={{ marginTop: \"10px\" }}\n              >\n                Add Comment\n              </Button>\n            </div>\n          </div>\n        ))\n      )}\n    </div>\n  );\n}\n\nexport default UserPhotos;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}